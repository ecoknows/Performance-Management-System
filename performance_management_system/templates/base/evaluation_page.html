{% extends 'base.html'%}
{% load wagtailcore_tags forloop_tags wagtailimages_tags static %}

{% block body_class %}
	flex
	flex-col
	h-screen
{% endblock %}

{% block header %}
	{% include 'includes/header.html' with user_model=user_model employee_model=employee_model menu_text='Evaluation'%}
	<div class="notify "style="z-index: 2000;"><span id="notifyType" class="" ></span></div>  
{% endblock %}

{% block head_style %}
<link rel="stylesheet" type="text/css" href="{% static 'css/evaluation_page.css' %}">
<link rel="stylesheet" type="text/css" href="{% static 'css/modal.css' %}">
{% endblock %}

{% block style %}
<style>
	#legend-evaluation ul{
		list-style-type: disc;
	}
	#legend-evaluation ol, ul{
		padding-left: 50px;
	}
	#legend-evaluation hr{
		border-top: 1px solid rgb(49, 49, 49);
		margin-top: 5px;
		margin-bottom: 5px;
	}
	#legend-evaluation p:empty { height: 1.5rem; }
	#legend-evaluation p { font-size: 1.1rem; }
	#legend-evaluation h2 { font-size: 2rem; }
	#legend-evaluation h4 { font-size: 1.2rem; }
</style>
{% endblock %}
{% block content %}
<section  class="container mx-auto starting-padding-top" id='evaluation-page'>

	{% if disabled %}
	<div class="flex flex-col items-center py-10">
		<div class="flex space-x-4">
			{% image user_evaluation.employee.profile_pic fill-120x120 as employee_pic %}
			<img src="{{employee_pic.url}}" class="rounded-full" style="width: 120px; height: 120px;">
			
			<div class="flex flex-col justify-center">
			<h1 class="font-sans text-3xl font-bold" style="color: #616161;">
				{{user_evaluation.employee}}
			</h1>
			<h2 class="font-sans text-lg font-semibold" style="color: #979797;">
				{{user_evaluation.employee.position}}
			</h2>
			</div>
		</div>

	</div>

	{% endif %}

	
	<div class="pb-4 pl-8 show-on-print">
		<h1 class="font-sans text-xl font-bold text-gray">Client</h1>
		<div class="flex space-x-2">
			{% image user_evaluation.client.profile_pic fill-40x40 as client_pic %}
			<img src="{{client_pic.url}}" class="rounded-full" style="width: 40px; height: 40px;">
			
			<div class="flex flex-col justify-center">
				<h1 class="font-sans text-xl font-bold" style="color: #616161;">
					{{user_evaluation.client}}
				</h1>
			</div>
		</div>
	</div>

	<div id='legend-evaluation' class="px-6 font-sans" style="color: #353535;">
		{{ self.legend_evaluation|richtext }}
	</div>

	<div class="flex px-6 py-6 font-sans text-xl" style="color: #353535;">
		<div class="flex-1">
			<div>
				<h1 class="inline-block font-bold">Employee Name: </h1>
				<h1 class="inline-block">{{employee_model}}</h1>
			</div>
			
			<div>
				<h1 class="inline-block font-bold">Project Assign: </h1>
				<h1 class="inline-block">{{user_evaluation.project_assign}}</h1>
			</div>
			

		</div>

		<div class="flex-1">
			
			<div>
				<h1 class="inline-block font-bold">Position: </h1>
				<h1 class="inline-block">{{employee_model.position}}</h1>
			</div>
			
			<div>
				<h1 class="inline-block font-bold">Hiring Date: </h1>
				<h1 class="inline-block">{{user_evaluation.submit_date}}</h1>
			</div>

		</div>
	</div>

	<form method="POST">
		{% csrf_token %}
		<div>
			<div class="flex">
				<div class="flex-1">
			
				</div>
			</div>
			{% for category in evaluation_categories %}
			<div>
				<div class="flex flex-col px-4 py-2 text-white lg:flex-row " style="background-color: #2b4949;">
					<div class="flex-1">
						<label class="font-sans text-2xl font-bold ">
							{{category}}
						</label>
					</div>
					<div class="flex justify-end flex-1 lg:justify-center">
			{% for rates in self.evaluation_max_rate|times %}
						<h1 style='margin-right: 1rem; width: 30px; text-align:center;' class="font-sans text-lg font-semibold">{{forloop.counter}}</h1>
			{% endfor %}
					</div>
				</div>
				{% for rate in category.evaluation_rates.all %}
						<div class="flex flex-col px-4 py-2 space-y-2 border-b border-gray-600 lg:flex-row lg:space-y-0 " style="min-height: 50px;">
							<div class="flex-1">
								<label class="font-sans text-xl">
									{{rate}}
								</label>
							</div>
				{% get_rate_assign rate user_evaluation %}
							<div class="flex items-center justify-end flex-1 lg:justify-center">
								{% for i in self.evaluation_max_rate|times %}
									<input type="radio" {% if  disabled %} disabled {% endif %}  name="question-{{rate.pk}}" value="{{forloop.counter}}" {% if rate.rate == forloop.counter %}checked{% endif %} required class=" option-input radio"
										style='
										color: white;
										font-family: "Helvetica Neue", "Helvetica", "Roboto", "Arial", sans-serif;
										'
									>
								{% endfor %}
							</div>
						</div>
					{% endfor %}
				<div>
					<div class="flex flex-col px-4 py-2 text-white lg:flex-row " style="background-color: #2b4949;">
						<h1>	
							Indicate specific tasks or critical incidences covered by the competency and your remarks on their outputs
						</h1>
					</div>
					<textarea name='task-{{category.pk}}' rows="4" class="p-4" style="width: 100%; background-color: transparent;" placeholder='Please type here....' required>{% get_task user_evaluation category %}</textarea>
				</div>
				{% endfor %}
			</div>
		</div>
	{% if disabled == None and user_evaluation.percentage == 0  %}
	<div class="flex items-center justify-center py-10">
		<input id='submit-evaluation' type="submit" name='submit-btn' style="background-color: #2b4949;" value="SUBMIT EVALUATION" class="px-4 py-2 font-sans text-lg font-semibold text-white">
	</div>
	{% endif %}
	</form>
</section>
{% endblock %}

{% block scripts %}
<script>
	let submit_success = '{{submit_success}}'
</script>
<script src="{% static 'js/modal.js' %}"></script>
<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.5.3/jspdf.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.5.0-beta4/html2canvas.min.js"></script> -->
<script src="{% static 'js/autoPrint.js' %}"></script>
<script src="{% static 'js/header_search.js' %}"></script>
{% endblock %}